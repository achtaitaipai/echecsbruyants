function e(e){return e&&e.__esModule?e.default:e}function n(e,n){this.cnPos=e,this.pos=e,this.isWhite=n,this.draw=function(e){const n=e.ctx,t=e.cellWidth,r=e.cellHeight,o=this.pos.x*t+t/2,a=this.pos.y*r+r/2,i=.15*t;n.beginPath(),n.arc(o,a,i,0,2*Math.PI,!1),this.isWhite?(n.strokeStyle="rgb(0, 0, 0)",n.stroke()):(n.fillStyle="rgb(0, 0, 0)",n.fill()),n.closePath()}}function t(e,n){this.cnPos=e,this.pos=e,this.isWhite=n,this.draw=function(e){const n=e.ctx,t=e.cellWidth,r=e.cellHeight,o=.4*t,a=.6*r,i=this.pos.x*t+.5*(t-o),s=this.pos.y*r+.5*(r-a);this.isWhite?(n.strokeStyle="rgb(0,0,0)",n.strokeRect(i,s,o,a)):(n.fillStyle="rgb(0,0,0)",n.fillRect(i,s,o,a))}}function r(e,n){this.cnPos=e,this.pos=e,this.isWhite=n,this.draw=function(e){const n=e.ctx,t=e.cellWidth,r=e.cellHeight,o=.5*t,a=.2*t,i=.3*t,s=.6*t,l=.5*-i,u=.5*-s,c=this.pos.x*t+o,f=this.pos.y*r+o;n.translate(c,f),this.isWhite||n.scale(-1,1),n.beginPath(),n.moveTo(l,u),n.lineTo(l+o,u),n.lineTo(l+o,u+a),n.lineTo(l+i,u+a),n.lineTo(l+i,u+s),n.lineTo(l,u+s),n.closePath(),n.setTransform(1,0,0,1,0,0),n.strokeStyle="rgb(0, 0, 0)",this.isWhite?(n.strokeStyle="rgb(0, 0, 0)",n.stroke()):(n.fillStyle="rgb(0, 0, 0)",n.fill())}}function o(e,n){this.cnPos=e,this.pos=e,this.isWhite=n,this.draw=function(e){const n=e.ctx,t=e.cellWidth,r=e.cellHeight,o=.4*t,a=.6*r,i=this.pos.x*t+.5*t,s=this.pos.y*r+.5*(r-a);n.beginPath(),n.moveTo(i,s),n.lineTo(i+.5*o,s+a),n.lineTo(i-.5*o,s+a),n.closePath(),n.strokeStyle="rgb(0, 0, 0)",this.isWhite?(n.strokeStyle="rgb(0, 0, 0)",n.stroke()):(n.fillStyle="rgb(0, 0, 0)",n.fill())}}function a(e,n){this.cnPos=e,this.pos=e,this.isWhite=n,this.draw=function(e){const n=e.ctx,t=e.cellWidth,r=e.cellHeight,o=.6*t,a=.1*t,i=.1*r,s=.6*r,l=.5*(t-i)-.5*t,u=.5*(r-s)-.5*r,c=this.pos.x*t+.5*t,f=this.pos.y*r+.5*r;n.translate(c,f),n.rotate(45*Math.PI/180),n.beginPath(),n.moveTo(l,u),n.lineTo(l+i,u),n.lineTo(l+i,u+.5*(s-a)),n.lineTo(l+i+.5*(o-i),u+.5*(s-a)),n.lineTo(l+i+.5*(o-i),u+.5*(s+a)),n.lineTo(l+i,u+.5*(s+a)),n.lineTo(l+i,u+s),n.lineTo(l,u+s),n.lineTo(l,u+.5*(s+a)),n.lineTo(l-.5*(o-i),u+.5*(s+a)),n.lineTo(l-.5*(o-i),u+.5*(s-a)),n.lineTo(l,u+.5*(s-a)),n.closePath(),n.setTransform(1,0,0,1,0,0),n.strokeStyle="rgb(0, 0, 0)",this.isWhite?(n.strokeStyle="rgb(0, 0, 0)",n.stroke()):(n.fillStyle="rgb(0, 0, 0)",n.fill())}}function i(e,n){this.cnPos=e,this.pos=e,this.isWhite=n,this.draw=function(e){const n=e.ctx,t=e.cellWidth,r=e.cellHeight,o=.6*t,a=.2*t,i=.2*r,s=.6*r,l=.5*(t-i)-.5*t,u=.5*(r-s)-.5*r,c=this.pos.x*t+.5*t,f=this.pos.y*r+.5*r;n.translate(c,f),n.beginPath(),n.moveTo(l,u),n.lineTo(l+i,u),n.lineTo(l+i,u+.5*(s-a)),n.lineTo(l+i+.5*(o-i),u+.5*(s-a)),n.lineTo(l+i+.5*(o-i),u+.5*(s+a)),n.lineTo(l+i,u+.5*(s+a)),n.lineTo(l+i,u+s),n.lineTo(l,u+s),n.lineTo(l,u+.5*(s+a)),n.lineTo(l-.5*(o-i),u+.5*(s+a)),n.lineTo(l-.5*(o-i),u+.5*(s-a)),n.lineTo(l,u+.5*(s-a)),n.closePath(),n.setTransform(1,0,0,1,0,0),n.strokeStyle="rgb(0, 0, 0)",this.isWhite?(n.strokeStyle="rgb(0, 0, 0)",n.stroke()):(n.fillStyle="rgb(0, 0, 0)",n.fill())}}const s="SetUp",l="FEN";class u{clear(){this.tags={}}render(){let e="";for(const n in this.tags)e+=`[${n} "${this.tags[n]}"]\n`;return e}constructor(e=""){this.clear();const n=e.match(/\[([^\]]+)]/g);if(n&&n.length>0)for(let e=0;e<n.length;e++){let t=n[e].match(/\[(\w+)\s+"([^"]+)"/);t&&(this.tags[t[1]]=t[2])}}}function c(e,n,t,r){this.message=e,this.expected=n,this.found=t,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,c)}function f(e,n){n=void 0!==n?n:{};var t,r={},o={pgn:Pe},a=Pe,i=Ae("1:0",!1),s=Ae("0:1",!1),l=Ae("1-0",!1),u=Ae("0-1",!1),f="1/2-1/2",h=Ae("1/2-1/2",!1),p=Ae("*",!1),d=/^[^}]/,v=Ce(["}"],!0,!1),g=Ae("{",!1),m=Ae("}",!1),b=Ae("(",!1),x=Ae(")",!1),R=".",B=Ae(".",!1),y=Ne("integer"),Q=/^[0-9]/,E=Ce([["0","9"]],!1,!1),A=function(e){return parseInt(e.join(""),10)},C=Ae(" ",!1),N="O-O-O",K=Ae("O-O-O",!1),S=Ae("O-O",!1),w="+-",k=Ae("+-",!1),P=Ae("+",!1),T=function(e){return e[1]},O=Ae("$$$",!1),_=Ae("#",!1),$=Ae("=",!1),L=Ae("$",!1),I="!!",q=Ae("!!",!1),D="??",U=Ae("??",!1),W="!?",j=Ae("!?",!1),M="?!",F=Ae("?!",!1),G=Ae("!",!1),H=Ae("?",!1),z=Ae("‼",!1),V=Ae("⁇",!1),Z=Ae("⁉",!1),J=Ae("⁈",!1),X=Ae("□",!1),Y=Ae("∞",!1),ee=Ae("⩲",!1),ne=Ae("⩱",!1),te=Ae("±",!1),re=Ae("∓",!1),oe="-+",ae=Ae("-+",!1),ie=Ae("⨀",!1),se=Ae("⟳",!1),le=Ae("→",!1),ue=Ae("↑",!1),ce=Ae("⇆",!1),fe=Ae("D",!1),he=/^[RNBQKP]/,pe=Ce(["R","N","B","Q","K","P"],!1,!1),de=/^[a-h]/,ve=Ce([["a","h"]],!1,!1),ge=/^[1-8]/,me=Ce([["1","8"]],!1,!1),be=Ae("x",!1),xe=Ae("-",!1),Re=0,Be=[{line:1,column:1}],ye=0,Qe=[],Ee=0;if("startRule"in n){if(!(n.startRule in o))throw new Error("Can't start parsing from rule \""+n.startRule+'".');a=o[n.startRule]}function Ae(e,n){return{type:"literal",text:e,ignoreCase:n}}function Ce(e,n,t){return{type:"class",parts:e,inverted:n,ignoreCase:t}}function Ne(e){return{type:"other",description:e}}function Ke(n){var t,r=Be[n];if(r)return r;for(t=n-1;!Be[t];)t--;for(r={line:(r=Be[t]).line,column:r.column};t<n;)10===e.charCodeAt(t)?(r.line++,r.column=1):r.column++,t++;return Be[n]=r,r}function Se(e,n){var t=Ke(e),r=Ke(n);return{start:{offset:e,line:t.line,column:t.column},end:{offset:n,line:r.line,column:r.column}}}function we(e){Re<ye||(Re>ye&&(ye=Re,Qe=[]),Qe.push(e))}function ke(e,n,t){return new c(c.buildMessage(e,n),e,n,t)}function Pe(){var e,n,t,o,a;return e=Re,n=function(){var e,n;e=Re,(n=Oe())!==r&&(e,n=n);return e=n}(),n!==r?((t=_e())===r&&(t=null),t!==r?(e,o=n,(a=t||[]).unshift(o),e=n=a):(Re=e,e=r)):(Re=e,e=r),e===r&&(e=Re,(n=Te())!==r?((t=Oe())===r&&(t=null),t!==r?(e,n=function(e,n){var t=n||[];return t.unshift(e),t}(n,t),e=n):(Re=e,e=r)):(Re=e,e=r),e===r&&(e=Re,(n=je())===r&&(n=null),n!==r&&(e,n=[[]]),e=n)),e}function Te(){var e,n;return e=Re,(n=_e())!==r&&(e,n=n),e=n}function Oe(){var n,t,o,a,i,s,l,u,c,f,h,p,d,v,g,m,b,x,y,Q,E,A,C,N;return n=Re,(t=je())===r&&(t=null),t!==r?((o=Le())===r&&(o=null),o!==r?((a=je())===r&&(a=null),a!==r?(i=function(){var n,t,o;n=Re,(t=We())!==r?(46===e.charCodeAt(Re)?(o=R,Re++):(o=r,0===Ee&&we(B)),o===r&&(o=null),o!==r?(n,n=t=t):(Re=n,n=r)):(Re=n,n=r);return n}(),i===r&&(i=null),i!==r?((s=je())===r&&(s=null),s!==r?((l=Le())===r&&(l=null),l!==r?((u=je())===r&&(u=null),u!==r&&(c=Me())!==r?((f=je())===r&&(f=null),f!==r?((h=He())===r&&(h=null),h!==r?((p=je())===r&&(p=null),p!==r?((d=Le())===r&&(d=null),d!==r?((v=je())===r&&(v=null),v!==r?((g=Ie())===r&&(g=null),g!==r?((m=_e())===r&&(m=null),m!==r?(n,b=o,x=l,y=c,Q=h,E=d,A=g,C=m||[],(N={turn:"w"}).moveNumber=i,N.notation=y,N.commentBefore=x,N.commentAfter=E,N.commentMove=b,N.variations=A||[],N.nag=Q||null,C.unshift(N),n=t=C):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r),n===r&&(n=$e()),n}function _e(){var e,n,t,o,a,i,s,l,u,c,f,h,p,d,v,g,m,b,x,R,B,y,Q;return e=Re,(n=je())===r&&(n=null),n!==r?((t=Le())===r&&(t=null),t!==r?((o=je())===r&&(o=null),o!==r?((a=Ve())===r&&(a=null),a!==r?((i=je())===r&&(i=null),i!==r?((s=Le())===r&&(s=null),s!==r?((l=je())===r&&(l=null),l!==r&&(u=Me())!==r?((c=je())===r&&(c=null),c!==r?((f=He())===r&&(f=null),f!==r?((h=je())===r&&(h=null),h!==r?((p=Le())===r&&(p=null),p!==r?((d=je())===r&&(d=null),d!==r?((v=qe())===r&&(v=null),v!==r?((g=Oe())===r&&(g=null),g!==r?(e,m=s,b=u,x=f,R=p,B=v,y=g||[],(Q={turn:"b"}).moveNumber=a,Q.notation=b,Q.commentBefore=m,Q.commentAfter=R,Q.variations=B||[],y.unshift(Q),Q.nag=x||null,e=n=y):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r),e===r&&(e=$e()),e}function $e(){var n,t;return n=Re,"1:0"===e.substr(Re,3)?(t="1:0",Re+=3):(t=r,0===Ee&&we(i)),t!==r&&(n,t=["1:0"]),(n=t)===r&&(n=Re,"0:1"===e.substr(Re,3)?(t="0:1",Re+=3):(t=r,0===Ee&&we(s)),t!==r&&(n,t=["0:1"]),(n=t)===r&&(n=Re,"1-0"===e.substr(Re,3)?(t="1-0",Re+=3):(t=r,0===Ee&&we(l)),t!==r&&(n,t=["1-0"]),(n=t)===r&&(n=Re,"0-1"===e.substr(Re,3)?(t="0-1",Re+=3):(t=r,0===Ee&&we(u)),t!==r&&(n,t=["0-1"]),(n=t)===r&&(n=Re,e.substr(Re,7)===f?(t=f,Re+=7):(t=r,0===Ee&&we(h)),t!==r&&(n,t=["1/2-1/2"]),(n=t)===r&&(n=Re,42===e.charCodeAt(Re)?(t="*",Re++):(t=r,0===Ee&&we(p)),t!==r&&(n,t=["*"]),n=t))))),n}function Le(){var n,t,o,a;if(n=Re,t=function(){var n;123===e.charCodeAt(Re)?(n="{",Re++):(n=r,0===Ee&&we(g));return n}(),t!==r){for(o=[],d.test(e.charAt(Re))?(a=e.charAt(Re),Re++):(a=r,0===Ee&&we(v));a!==r;)o.push(a),d.test(e.charAt(Re))?(a=e.charAt(Re),Re++):(a=r,0===Ee&&we(v));o!==r?(a=function(){var n;125===e.charCodeAt(Re)?(n="}",Re++):(n=r,0===Ee&&we(m));return n}(),a!==r?(n,n=t=o.join("").trim()):(Re=n,n=r)):(Re=n,n=r)}else Re=n,n=r;return n}function Ie(){var e,n,t,o,a,i,s,l;return e=Re,De()!==r&&(n=Oe())!==r&&Ue()!==r?((t=je())===r&&(t=null),t!==r?((o=Ie())===r&&(o=null),o!==r?((a=je())===r&&(a=null),a!==r?((i=Ve())===r&&(i=null),i!==r?(e,s=n,(l=o||[]).unshift(s),e=l):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r),e}function qe(){var e,n,t,o,a,i;return e=Re,De()!==r&&(n=Te())!==r&&Ue()!==r?((t=je())===r&&(t=null),t!==r?((o=qe())===r&&(o=null),o!==r?(e,a=n,(i=o||[]).unshift(a),e=i):(Re=e,e=r)):(Re=e,e=r)):(Re=e,e=r),e}function De(){var n;return 40===e.charCodeAt(Re)?(n="(",Re++):(n=r,0===Ee&&we(b)),n}function Ue(){var n;return 41===e.charCodeAt(Re)?(n=")",Re++):(n=r,0===Ee&&we(x)),n}function We(){var n,t,o;if(Ee++,n=Re,t=[],Q.test(e.charAt(Re))?(o=e.charAt(Re),Re++):(o=r,0===Ee&&we(E)),o!==r)for(;o!==r;)t.push(o),Q.test(e.charAt(Re))?(o=e.charAt(Re),Re++):(o=r,0===Ee&&we(E));else t=r;return t!==r&&(n,t=A(t)),Ee--,(n=t)===r&&(t=r,0===Ee&&we(y)),n}function je(){var n,t,o;if(n=Re,t=[],32===e.charCodeAt(Re)?(o=" ",Re++):(o=r,0===Ee&&we(C)),o!==r)for(;o!==r;)t.push(o),32===e.charCodeAt(Re)?(o=" ",Re++):(o=r,0===Ee&&we(C));else t=r;return t!==r&&(n,t=""),n=t}function Me(){var n,t,o,a,i,s,l,u,c,f,h,p,d,v,g,m,b;return n=Re,(t=Ze())===r&&(t=null),t!==r?(o=Re,Ee++,a=function(){var e,n,t,o,a;e=Re,(n=ze())!==r?((t=Ye())===r&&(t=null),t!==r&&(o=Je())!==r&&(a=Xe())!==r?e=n=[n,t,o,a]:(Re=e,e=r)):(Re=e,e=r);return e}(),Ee--,a!==r?(Re=o,o=void 0):o=r,o!==r&&(a=ze())!==r?((i=Ye())===r&&(i=null),i!==r&&(s=Je())!==r&&(l=Xe())!==r?((u=Ge())===r&&(u=null),u!==r?((c=Fe())===r&&(c=null),c!==r?(n,h=a,p=i,d=s,v=l,g=u,m=c,(b={}).fig=(f=t)||null,b.disc=h||null,b.strike=p||null,b.col=d,b.row=v,b.check=m||null,b.promotion=g,b.notation=(f||"")+(h||"")+(p||"")+d+v+(g||"")+(m||""),n=t=b):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r),n===r&&(n=Re,(t=Ze())===r&&(t=null),t!==r&&(o=Je())!==r&&(a=Xe())!==r?(i=function(){var n;120===e.charCodeAt(Re)?(n="x",Re++):(n=r,0===Ee&&we(be));n===r&&(45===e.charCodeAt(Re)?(n="-",Re++):(n=r,0===Ee&&we(xe)));return n}(),i===r&&(i=null),i!==r&&(s=Je())!==r&&(l=Xe())!==r?((u=Ge())===r&&(u=null),u!==r?((c=Fe())===r&&(c=null),c!==r?(n,t=function(e,n,t,r,o,a,i,s){var l={};return l.fig=e||null,l.strike="x"==r?r:null,l.col=o,l.row=a,l.check=s||null,l.notation=(e&&"P"!==e?e:"")+n+t+("x"==r?r:"-")+o+a+(i||"")+(s||""),l.promotion=i,l}(t,o,a,i,s,l,u,c),n=t):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r),n===r&&(n=Re,(t=Ze())===r&&(t=null),t!==r?((o=Ye())===r&&(o=null),o!==r&&(a=Je())!==r&&(i=Xe())!==r?((s=Ge())===r&&(s=null),s!==r?((l=Fe())===r&&(l=null),l!==r?(n,t=function(e,n,t,r,o,a){var i={};return i.fig=e||null,i.strike=n||null,i.col=t,i.row=r,i.check=a||null,i.notation=(e||"")+(n||"")+t+r+(o||"")+(a||""),i.promotion=o,i}(t,o,a,i,s,l),n=t):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r),n===r&&(n=Re,e.substr(Re,5)===N?(t=N,Re+=5):(t=r,0===Ee&&we(K)),t!==r?((o=Fe())===r&&(o=null),o!==r?(n,t=function(e){var n={};return n.notation="O-O-O"+(e||""),n.check=e||null,n}(o),n=t):(Re=n,n=r)):(Re=n,n=r),n===r&&(n=Re,"O-O"===e.substr(Re,3)?(t="O-O",Re+=3):(t=r,0===Ee&&we(S)),t!==r?((o=Fe())===r&&(o=null),o!==r?(n,t=function(e){var n={};return n.notation="O-O"+(e||""),n.check=e||null,n}(o),n=t):(Re=n,n=r)):(Re=n,n=r))))),n}function Fe(){var n,t,o,a;return n=Re,t=Re,o=Re,Ee++,e.substr(Re,2)===w?(a=w,Re+=2):(a=r,0===Ee&&we(k)),Ee--,a===r?o=void 0:(Re=o,o=r),o!==r?(43===e.charCodeAt(Re)?(a="+",Re++):(a=r,0===Ee&&we(P)),a!==r?t=o=[o,a]:(Re=t,t=r)):(Re=t,t=r),t!==r&&(n,t=T(t)),(n=t)===r&&(n=Re,t=Re,o=Re,Ee++,"$$$"===e.substr(Re,3)?(a="$$$",Re+=3):(a=r,0===Ee&&we(O)),Ee--,a===r?o=void 0:(Re=o,o=r),o!==r?(35===e.charCodeAt(Re)?(a="#",Re++):(a=r,0===Ee&&we(_)),a!==r?t=o=[o,a]:(Re=t,t=r)):(Re=t,t=r),t!==r&&(n,t=T(t)),n=t),n}function Ge(){var n,t,o;return n=Re,61===e.charCodeAt(Re)?(t="=",Re++):(t=r,0===Ee&&we($)),t!==r&&(o=Ze())!==r?(n,n=t="="+o):(Re=n,n=r),n}function He(){var n,t,o,a,i,s;return n=Re,t=function(){var n,t,o;n=Re,36===e.charCodeAt(Re)?(t="$",Re++):(t=r,0===Ee&&we(L));t!==r&&(o=We())!==r?(n,n=t="$"+o):(Re=n,n=r);n===r&&(n=Re,e.substr(Re,2)===I?(t=I,Re+=2):(t=r,0===Ee&&we(q)),t!==r&&(n,t="$3"),(n=t)===r&&(n=Re,e.substr(Re,2)===D?(t=D,Re+=2):(t=r,0===Ee&&we(U)),t!==r&&(n,t="$4"),(n=t)===r&&(n=Re,e.substr(Re,2)===W?(t=W,Re+=2):(t=r,0===Ee&&we(j)),t!==r&&(n,t="$5"),(n=t)===r&&(n=Re,e.substr(Re,2)===M?(t=M,Re+=2):(t=r,0===Ee&&we(F)),t!==r&&(n,t="$6"),(n=t)===r&&(n=Re,33===e.charCodeAt(Re)?(t="!",Re++):(t=r,0===Ee&&we(G)),t!==r&&(n,t="$1"),(n=t)===r&&(n=Re,63===e.charCodeAt(Re)?(t="?",Re++):(t=r,0===Ee&&we(H)),t!==r&&(n,t="$2"),(n=t)===r&&(n=Re,8252===e.charCodeAt(Re)?(t="‼",Re++):(t=r,0===Ee&&we(z)),t!==r&&(n,t="$3"),(n=t)===r&&(n=Re,8263===e.charCodeAt(Re)?(t="⁇",Re++):(t=r,0===Ee&&we(V)),t!==r&&(n,t="$4"),(n=t)===r&&(n=Re,8265===e.charCodeAt(Re)?(t="⁉",Re++):(t=r,0===Ee&&we(Z)),t!==r&&(n,t="$5"),(n=t)===r&&(n=Re,8264===e.charCodeAt(Re)?(t="⁈",Re++):(t=r,0===Ee&&we(J)),t!==r&&(n,t="$6"),(n=t)===r&&(n=Re,9633===e.charCodeAt(Re)?(t="□",Re++):(t=r,0===Ee&&we(X)),t!==r&&(n,t="$7"),(n=t)===r&&(n=Re,61===e.charCodeAt(Re)?(t="=",Re++):(t=r,0===Ee&&we($)),t!==r&&(n,t="$10"),(n=t)===r&&(n=Re,8734===e.charCodeAt(Re)?(t="∞",Re++):(t=r,0===Ee&&we(Y)),t!==r&&(n,t="$13"),(n=t)===r&&(n=Re,10866===e.charCodeAt(Re)?(t="⩲",Re++):(t=r,0===Ee&&we(ee)),t!==r&&(n,t="$14"),(n=t)===r&&(n=Re,10865===e.charCodeAt(Re)?(t="⩱",Re++):(t=r,0===Ee&&we(ne)),t!==r&&(n,t="$15"),(n=t)===r&&(n=Re,177===e.charCodeAt(Re)?(t="±",Re++):(t=r,0===Ee&&we(te)),t!==r&&(n,t="$16"),(n=t)===r&&(n=Re,8723===e.charCodeAt(Re)?(t="∓",Re++):(t=r,0===Ee&&we(re)),t!==r&&(n,t="$17"),(n=t)===r&&(n=Re,e.substr(Re,2)===w?(t=w,Re+=2):(t=r,0===Ee&&we(k)),t!==r&&(n,t="$18"),(n=t)===r&&(n=Re,e.substr(Re,2)===oe?(t=oe,Re+=2):(t=r,0===Ee&&we(ae)),t!==r&&(n,t="$19"),(n=t)===r&&(n=Re,10752===e.charCodeAt(Re)?(t="⨀",Re++):(t=r,0===Ee&&we(ie)),t!==r&&(n,t="$22"),(n=t)===r&&(n=Re,10227===e.charCodeAt(Re)?(t="⟳",Re++):(t=r,0===Ee&&we(se)),t!==r&&(n,t="$32"),(n=t)===r&&(n=Re,8594===e.charCodeAt(Re)?(t="→",Re++):(t=r,0===Ee&&we(le)),t!==r&&(n,t="$36"),(n=t)===r&&(n=Re,8593===e.charCodeAt(Re)?(t="↑",Re++):(t=r,0===Ee&&we(ue)),t!==r&&(n,t="$40"),(n=t)===r&&(n=Re,8646===e.charCodeAt(Re)?(t="⇆",Re++):(t=r,0===Ee&&we(ce)),t!==r&&(n,t="$132"),(n=t)===r&&(n=Re,68===e.charCodeAt(Re)?(t="D",Re++):(t=r,0===Ee&&we(fe)),t!==r&&(n,t="$220"),n=t)))))))))))))))))))))))));return n}(),t!==r?((o=je())===r&&(o=null),o!==r?((a=He())===r&&(a=null),a!==r?(n,i=t,(s=a||[]).unshift(i),n=t=s):(Re=n,n=r)):(Re=n,n=r)):(Re=n,n=r),n}function ze(){var e;return(e=Je())===r&&(e=Xe()),e}function Ve(){var n,t,o,a;if(n=Re,(t=We())!==r){if(o=[],46===e.charCodeAt(Re)?(a=R,Re++):(a=r,0===Ee&&we(B)),a!==r)for(;a!==r;)o.push(a),46===e.charCodeAt(Re)?(a=R,Re++):(a=r,0===Ee&&we(B));else o=r;o!==r?(n,n=t=t):(Re=n,n=r)}else Re=n,n=r;return n}function Ze(){var n;return he.test(e.charAt(Re))?(n=e.charAt(Re),Re++):(n=r,0===Ee&&we(pe)),n}function Je(){var n;return de.test(e.charAt(Re))?(n=e.charAt(Re),Re++):(n=r,0===Ee&&we(ve)),n}function Xe(){var n;return ge.test(e.charAt(Re))?(n=e.charAt(Re),Re++):(n=r,0===Ee&&we(me)),n}function Ye(){var n;return 120===e.charCodeAt(Re)?(n="x",Re++):(n=r,0===Ee&&we(be)),n}if((t=a())!==r&&Re===e.length)return t;throw t!==r&&Re<e.length&&we({type:"end"}),ke(Qe,ye<e.length?e.charAt(ye):null,ye<e.length?Se(ye,ye+1):Se(ye,ye))}!function(e,n){function t(){this.constructor=e}t.prototype=n.prototype,e.prototype=new t}(c,Error),c.buildMessage=function(e,n){var t,r={literal:function(e){return'"'+a(e.text)+'"'},class:function(e){var n,t="";for(n=0;n<e.parts.length;n++)t+=e.parts[n]instanceof Array?i(e.parts[n][0])+"-"+i(e.parts[n][1]):i(e.parts[n]);return"["+(e.inverted?"^":"")+t+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function o(e){return e.charCodeAt(0).toString(16).toUpperCase()}function a(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+o(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+o(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+o(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+o(e)}))}return"Expected "+function(e){var n,t,o,a=new Array(e.length);for(n=0;n<e.length;n++)a[n]=(o=e[n],r[o.type](o));if(a.sort(),a.length>0){for(n=1,t=1;n<a.length;n++)a[n-1]!==a[n]&&(a[t]=a[n],t++);a.length=t}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+(((t=n)?'"'+a(t)+'"':"end of input")+" found.")};var h,p,d,v,g={};h=g,p="Chess",d=function(){return m},v=function(e){return m=e},Object.defineProperty(h,p,{get:d,set:v,enumerable:!0,configurable:!0});
/* @license
 * Copyright (c) 2018, Jeff Hlywa (jhlywa@gmail.com)
 * Released under the BSD license
 * https://github.com/jhlywa/chess.js/blob/master/LICENSE
 */
var m=function(e){var n="b",t="w",r=-1,o="p",a="b",i="k",s="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",l=["1-0","0-1","1/2-1/2","*"],u={b:[16,32,17,15],w:[-16,-32,-17,-15]},c={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},f=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],h=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],p={p:0,n:1,b:2,r:3,q:4,k:5},d={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},v={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},g={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},m={w:[{square:g.a1,flag:v.QSIDE_CASTLE},{square:g.h1,flag:v.KSIDE_CASTLE}],b:[{square:g.a8,flag:v.QSIDE_CASTLE},{square:g.h8,flag:v.KSIDE_CASTLE}]},b=new Array(128),x={w:r,b:r},R=t,B={w:0,b:0},y=r,Q=0,E=1,A=[],C={};function N(e){void 0===e&&(e=!1),b=new Array(128),x={w:r,b:r},R=t,B={w:0,b:0},y=r,Q=0,E=1,A=[],e||(C={}),T(k())}function K(){S(s)}function S(e,o){void 0===o&&(o=!1);var a=e.split(/\s+/),i=a[0],s=0;if(!w(e).valid)return!1;N(o);for(var l=0;l<i.length;l++){var u=i.charAt(l);if("/"===u)s+=8;else if(-1!=="0123456789".indexOf(u))s+=parseInt(u,10);else{var c=u<"a"?t:n;_({type:u.toLowerCase(),color:c},X(s)),s++}}return R=a[1],a[2].indexOf("K")>-1&&(B.w|=v.KSIDE_CASTLE),a[2].indexOf("Q")>-1&&(B.w|=v.QSIDE_CASTLE),a[2].indexOf("k")>-1&&(B.b|=v.KSIDE_CASTLE),a[2].indexOf("q")>-1&&(B.b|=v.QSIDE_CASTLE),y="-"===a[3]?r:g[a[3]],Q=parseInt(a[4],10),E=parseInt(a[5],10),T(k()),!0}function w(e){var n="No errors.",t="FEN string must contain six space-delimited fields.",r="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",a="4th field (en-passant square) is invalid.",i="3rd field (castling availability) is invalid.",s="2nd field (side to move) is invalid.",l="1st field (piece positions) does not contain 8 '/'-delimited rows.",u="1st field (piece positions) is invalid [consecutive numbers].",c="1st field (piece positions) is invalid [invalid piece].",f="1st field (piece positions) is invalid [row too large].",h="Illegal en-passant square",p=e.split(/\s+/);if(6!==p.length)return{valid:!1,error_number:1,error:t};if(isNaN(p[5])||parseInt(p[5],10)<=0)return{valid:!1,error_number:2,error:r};if(isNaN(p[4])||parseInt(p[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(p[3]))return{valid:!1,error_number:4,error:a};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(p[2]))return{valid:!1,error_number:5,error:i};if(!/^(w|b)$/.test(p[1]))return{valid:!1,error_number:6,error:s};var d=p[0].split("/");if(8!==d.length)return{valid:!1,error_number:7,error:l};for(var v=0;v<d.length;v++){for(var g=0,m=!1,b=0;b<d[v].length;b++)if(isNaN(d[v][b])){if(!/^[prnbqkPRNBQK]$/.test(d[v][b]))return{valid:!1,error_number:9,error:c};g+=1,m=!1}else{if(m)return{valid:!1,error_number:8,error:u};g+=parseInt(d[v][b],10),m=!0}if(8!==g)return{valid:!1,error_number:10,error:f}}return"3"==p[3][1]&&"w"==p[1]||"6"==p[3][1]&&"b"==p[1]?{valid:!1,error_number:11,error:h}:{valid:!0,error_number:0,error:n}}function k(){for(var e=0,n="",o=g.a8;o<=g.h1;o++){if(null==b[o])e++;else{e>0&&(n+=e,e=0);var a=b[o].color,i=b[o].type;n+=a===t?i.toUpperCase():i.toLowerCase()}o+1&136&&(e>0&&(n+=e),o!==g.h1&&(n+="/"),e=0,o+=8)}var s="";B.w&v.KSIDE_CASTLE&&(s+="K"),B.w&v.QSIDE_CASTLE&&(s+="Q"),B.b&v.KSIDE_CASTLE&&(s+="k"),B.b&v.QSIDE_CASTLE&&(s+="q"),s=s||"-";var l=y===r?"-":X(y);return[n,R,s,l,Q,E].join(" ")}function P(e){for(var n=0;n<e.length;n+=2)"string"==typeof e[n]&&"string"==typeof e[n+1]&&(C[e[n]]=e[n+1]);return C}function T(e){A.length>0||(e!==s?(C.SetUp="1",C.FEN=e):(delete C.SetUp,delete C.FEN))}function O(e){var n=b[g[e]];return n?{type:n.type,color:n.color}:null}function _(e,n){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(n in g))return!1;var t=g[n];return(e.type!=i||x[e.color]==r||x[e.color]==t)&&(b[t]={type:e.type,color:e.color},e.type===i&&(x[e.color]=t),T(k()),!0)}function $(e,n,t,r,a){var i={color:R,from:n,to:t,flags:r,piece:e[n].type};return a&&(i.flags|=v.PROMOTION,i.promotion=a),e[t]?i.captured=e[t].type:r&v.EP_CAPTURE&&(i.captured=o),i}function L(e){function n(e,n,t,r,i){if(e[t].type!==o||0!==Z(r)&&7!==Z(r))n.push($(e,t,r,i));else for(var s=["q","r",a,"n"],l=0,u=s.length;l<u;l++)n.push($(e,t,r,i,s[l]))}var t=[],r=R,i=Y(r),s={b:1,w:6},l=g.a8,f=g.h1,h=!1,p=void 0===e||!("legal"in e)||e.legal;if(void 0!==e&&"square"in e){if(!(e.square in g))return[];l=f=g[e.square],h=!0}for(var d=l;d<=f;d++)if(136&d)d+=7;else{var m=b[d];if(null!=m&&m.color===r)if(m.type===o){var Q=d+u[r][0];if(null==b[Q]){n(b,t,d,Q,v.NORMAL);Q=d+u[r][1];s[r]===Z(d)&&null==b[Q]&&n(b,t,d,Q,v.BIG_PAWN)}for(E=2;E<4;E++){136&(Q=d+u[r][E])||(null!=b[Q]&&b[Q].color===i?n(b,t,d,Q,v.CAPTURE):Q===y&&n(b,t,d,y,v.EP_CAPTURE))}}else for(var E=0,A=c[m.type].length;E<A;E++){var C=c[m.type][E];for(Q=d;!(136&(Q+=C));){if(null!=b[Q]){if(b[Q].color===r)break;n(b,t,d,Q,v.CAPTURE);break}if(n(b,t,d,Q,v.NORMAL),"n"===m.type||"k"===m.type)break}}}if(!h||f===x[r]){if(B[r]&v.KSIDE_CASTLE){var N=(K=x[r])+2;null!=b[K+1]||null!=b[N]||D(i,x[r])||D(i,K+1)||D(i,N)||n(b,t,x[r],N,v.KSIDE_CASTLE)}if(B[r]&v.QSIDE_CASTLE){var K;N=(K=x[r])-2;null!=b[K-1]||null!=b[K-2]||null!=b[K-3]||D(i,x[r])||D(i,K-1)||D(i,N)||n(b,t,x[r],N,v.QSIDE_CASTLE)}}if(!p)return t;var S=[];for(d=0,A=t.length;d<A;d++)H(t[d]),U(r)||S.push(t[d]),z();return S}function I(e,n){var t="";if(e.flags&v.KSIDE_CASTLE)t="O-O";else if(e.flags&v.QSIDE_CASTLE)t="O-O-O";else{var r=function(e,n){for(var t=L({legal:!n}),r=e.from,o=e.to,a=e.piece,i=0,s=0,l=0,u=0,c=t.length;u<c;u++){var f=t[u].from,h=t[u].to;a===t[u].piece&&r!==f&&o===h&&(i++,Z(r)===Z(f)&&s++,J(r)===J(f)&&l++)}if(i>0)return s>0&&l>0?X(r):l>0?X(r).charAt(1):X(r).charAt(0);return""}(e,n);e.piece!==o&&(t+=e.piece.toUpperCase()+r),e.flags&(v.CAPTURE|v.EP_CAPTURE)&&(e.piece===o&&(t+=X(e.from)[0]),t+="x"),t+=X(e.to),e.flags&v.PROMOTION&&(t+="="+e.promotion.toUpperCase())}return H(e),W()&&(j()?t+="#":t+="+"),z(),t}function q(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function D(e,r){for(var a=g.a8;a<=g.h1;a++)if(136&a)a+=7;else if(null!=b[a]&&b[a].color===e){var i=b[a],s=a-r,l=s+119;if(f[l]&1<<p[i.type]){if(i.type===o){if(s>0){if(i.color===t)return!0}else if(i.color===n)return!0;continue}if("n"===i.type||"k"===i.type)return!0;for(var u=h[l],c=a+u,d=!1;c!==r;){if(null!=b[c]){d=!0;break}c+=u}if(!d)return!0}}return!1}function U(e){return D(Y(e),x[e])}function W(){return U(R)}function j(){return W()&&0===L().length}function M(){return!W()&&0===L().length}function F(){for(var e={},n=[],t=0,r=0,o=g.a8;o<=g.h1;o++)if(r=(r+1)%2,136&o)o+=7;else{var i=b[o];i&&(e[i.type]=i.type in e?e[i.type]+1:1,i.type===a&&n.push(r),t++)}if(2===t)return!0;if(3===t&&(1===e.b||1===e.n))return!0;if(t===e.b+2){var s=0,l=n.length;for(o=0;o<l;o++)s+=n[o];if(0===s||s===l)return!0}return!1}function G(){for(var e=[],n={},t=!1;;){var r=z();if(!r)break;e.push(r)}for(;;){var o=k().split(" ").slice(0,4).join(" ");if(n[o]=o in n?n[o]+1:1,n[o]>=3&&(t=!0),!e.length)break;H(e.pop())}return t}function H(e){var t=R,a=Y(t);if(function(e){A.push({move:e,kings:{b:x.b,w:x.w},turn:R,castling:{b:B.b,w:B.w},ep_square:y,half_moves:Q,move_number:E})}(e),b[e.to]=b[e.from],b[e.from]=null,e.flags&v.EP_CAPTURE&&(R===n?b[e.to-16]=null:b[e.to+16]=null),e.flags&v.PROMOTION&&(b[e.to]={type:e.promotion,color:t}),b[e.to].type===i){if(x[b[e.to].color]=e.to,e.flags&v.KSIDE_CASTLE){var s=e.to-1,l=e.to+1;b[s]=b[l],b[l]=null}else if(e.flags&v.QSIDE_CASTLE){s=e.to+1,l=e.to-2;b[s]=b[l],b[l]=null}B[t]=""}if(B[t])for(var u=0,c=m[t].length;u<c;u++)if(e.from===m[t][u].square&&B[t]&m[t][u].flag){B[t]^=m[t][u].flag;break}if(B[a])for(u=0,c=m[a].length;u<c;u++)if(e.to===m[a][u].square&&B[a]&m[a][u].flag){B[a]^=m[a][u].flag;break}y=e.flags&v.BIG_PAWN?"b"===R?e.to-16:e.to+16:r,e.piece===o||e.flags&(v.CAPTURE|v.EP_CAPTURE)?Q=0:Q++,R===n&&E++,R=Y(R)}function z(){var e=A.pop();if(null==e)return null;var t=e.move;x=e.kings,R=e.turn,B=e.castling,y=e.ep_square,Q=e.half_moves,E=e.move_number;var r,a,i=R,s=Y(R);if(b[t.from]=b[t.to],b[t.from].type=t.piece,b[t.to]=null,t.flags&v.CAPTURE)b[t.to]={type:t.captured,color:s};else if(t.flags&v.EP_CAPTURE){var l;l=i===n?t.to-16:t.to+16,b[l]={type:o,color:s}}t.flags&(v.KSIDE_CASTLE|v.QSIDE_CASTLE)&&(t.flags&v.KSIDE_CASTLE?(r=t.to+1,a=t.to-1):t.flags&v.QSIDE_CASTLE&&(r=t.to-2,a=t.to+1),b[r]=b[a],b[a]=null);return t}function V(e,n){var t=q(e);if(n){var r=t.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(r)var o=r[1],a=r[2],i=r[3],s=r[4]}for(var l=L(),u=0,c=l.length;u<c;u++){if(t===q(I(l[u]))||n&&t===q(I(l[u],!0)))return l[u];if(r&&(!o||o.toLowerCase()==l[u].piece)&&g[a]==l[u].from&&g[i]==l[u].to&&(!s||s.toLowerCase()==l[u].promotion))return l[u]}return null}function Z(e){return e>>4}function J(e){return 15&e}function X(e){var n=J(e),t=Z(e);return"abcdefgh".substring(n,n+1)+"87654321".substring(t,t+1)}function Y(e){return e===t?n:t}function ee(e){var n=ne(e);n.san=I(n,!1),n.to=X(n.to),n.from=X(n.from);var t="";for(var r in v)v[r]&n.flags&&(t+=d[r]);return n.flags=t,n}function ne(e){var n=e instanceof Array?[]:{};for(var t in e)n[t]="object"==typeof t?ne(e[t]):e[t];return n}function te(e){return e.replace(/^\s+|\s+$/g,"")}function re(e){for(var n=L({legal:!1}),t=0,r=R,o=0,a=n.length;o<a;o++){if(H(n[o]),!U(r))if(e-1>0)t+=re(e-1);else t++;z()}return t}return S(void 0===e?s:e),{WHITE:t,BLACK:n,PAWN:o,KNIGHT:"n",BISHOP:a,ROOK:"r",QUEEN:"q",KING:i,SQUARES:function(){for(var e=[],n=g.a8;n<=g.h1;n++)136&n?n+=7:e.push(X(n));return e}(),FLAGS:d,load:function(e){return S(e)},reset:function(){return K()},moves:function(e){for(var n=L(e),t=[],r=0,o=n.length;r<o;r++)void 0!==e&&"verbose"in e&&e.verbose?t.push(ee(n[r])):t.push(I(n[r],!1));return t},in_check:function(){return W()},in_checkmate:function(){return j()},in_stalemate:function(){return M()},in_draw:function(){return Q>=100||M()||F()||G()},insufficient_material:function(){return F()},in_threefold_repetition:function(){return G()},game_over:function(){return Q>=100||j()||M()||F()||G()},validate_fen:function(e){return w(e)},fen:function(){return k()},board:function(){for(var e=[],n=[],t=g.a8;t<=g.h1;t++)null==b[t]?n.push(null):n.push({type:b[t].type,color:b[t].color}),t+1&136&&(e.push(n),n=[],t+=8);return e},pgn:function(e){var n="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",t="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,r=[],o=!1;for(var a in C)r.push("["+a+' "'+C[a]+'"]'+n),o=!0;o&&A.length&&r.push(n);for(var i=[];A.length>0;)i.push(z());for(var s=[],l="";i.length>0;){var u=i.pop();A.length||"b"!==u.color?"w"===u.color&&(l.length&&s.push(l),l=E+"."):l=E+". ...",l=l+" "+I(u,!1),H(u)}if(l.length&&s.push(l),void 0!==C.Result&&s.push(C.Result),0===t)return r.join("")+s.join(" ");var c=0;for(a=0;a<s.length;a++)c+s[a].length>t&&0!==a?(" "===r[r.length-1]&&r.pop(),r.push(n),c=0):0!==a&&(r.push(" "),c++),r.push(s[a]),c+=s[a].length;return r.join("")},load_pgn:function(e,n){var t=void 0!==n&&"sloppy"in n&&n.sloppy;function r(e){return e.replace(/\\/g,"\\")}var o="object"==typeof n&&"string"==typeof n.newline_char?n.newline_char:"\r?\n",a=new RegExp("^(\\[((?:"+r(o)+")|.)*\\])(?:"+r(o)+"){2}"),i=a.test(e)?a.exec(e)[1]:"";K();var s=function(e,n){for(var t="object"==typeof n&&"string"==typeof n.newline_char?n.newline_char:"\r?\n",o={},a=e.split(new RegExp(r(t))),i="",s="",l=0;l<a.length;l++)i=a[l].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),s=a[l].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),te(i).length>0&&(o[i]=s);return o}(i,n);for(var u in s)P([u,s[u]]);if(!("1"!==s.SetUp||"FEN"in s&&S(s.FEN,!0)))return!1;var c=e.replace(i,"").replace(new RegExp(r(o),"g")," ");c=c.replace(/(\{[^}]+\})+?/g,"");for(var f=/(\([^\(\)]+\))+?/g;f.test(c);)c=c.replace(f,"");var h=te(c=(c=(c=c.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));h=h.join(",").replace(/,,+/g,",").split(",");for(var p="",d=0;d<h.length-1;d++){if(null==(p=V(h[d],t)))return!1;H(p)}if(p=h[h.length-1],l.indexOf(p)>-1)(function(e){for(var n in e)return!0;return!1})(C)&&void 0===C.Result&&P(["Result",p]);else{if(null==(p=V(p,t)))return!1;H(p)}return!0},header:function(){return P(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",n=g.a8;n<=g.h1;n++){if(0===J(n)&&(e+=" "+"87654321"[Z(n)]+" |"),null==b[n])e+=" . ";else{var r=b[n].type;e+=" "+(b[n].color===t?r.toUpperCase():r.toLowerCase())+" "}n+1&136&&(e+="|\n",n+=8)}return e+="   +------------------------+\n",e+"     a  b  c  d  e  f  g  h\n"}()},turn:function(){return R},move:function(e,n){var t=void 0!==n&&"sloppy"in n&&n.sloppy,r=null;if("string"==typeof e)r=V(e,t);else if("object"==typeof e)for(var o=L(),a=0,i=o.length;a<i;a++)if(e.from===X(o[a].from)&&e.to===X(o[a].to)&&(!("promotion"in o[a])||e.promotion===o[a].promotion)){r=o[a];break}if(!r)return null;var s=ee(r);return H(r),s},undo:function(){var e=z();return e?ee(e):null},clear:function(){return N()},put:function(e,n){return _(e,n)},get:function(e){return O(e)},remove:function(e){return function(e){var n=O(e);return b[g[e]]=null,n&&n.type===i&&(x[n.color]=r),T(k()),n}(e)},perft:function(e){return re(e)},square_color:function(e){if(e in g){var n=g[e];return(Z(n)+J(n))%2==0?"light":"dark"}return null},history:function(e){for(var n=[],t=[],r=(void 0!==e&&"verbose"in e&&e.verbose);A.length>0;)n.push(z());for(;n.length>0;){var o=n.pop();r?t.push(ee(o)):t.push(I(o)),H(o)}return t}}};function b(e,n){this.fen=e,this.notation=n,this.toString=function(){return"IllegalMoveException: "+e+" => "+n}}void 0!==g&&(g.$389b963f4edc9b1c$export$a4d6ea685c300d39=m),"undefined"!=typeof define&&define((function(){return m}));class x{clear(){this.moves=[]}traverse(e,n,t,r=1,o=!1){const a=n?new g.Chess(n):new g.Chess,i=[];let s=t;for(let t of e){if(t.notation){const e=t.notation.notation,l=a.move(e,{sloppy:o});if(!l)throw new b(a.fen(),e);{s?(l.previous=s,s.next=l):l.previous=void 0,l.ply=r,this.fillMoveFromChessState(l,a),t.nag&&(l.nag=t.nag[0]),t.commentBefore&&(l.commentBefore=t.commentBefore),t.commentMove&&(l.commentMove=t.commentMove),t.commentAfter&&(l.commentAfter=t.commentAfter),l.variations=[];const e=t.variations;if(e.length>0){const t=i.length>0?i[i.length-1].fen:n;for(let n of e)l.variations.push(this.traverse(n,t,s,r,o))}l.variation=i,i.push(l),s=l}}r++}return i}fillMoveFromChessState(e,n){e.fen=n.fen(),e.variations=[],n.game_over()&&(e.gameOver=!0,n.in_draw()&&(e.inDraw=!0),n.in_stalemate()&&(e.inStalemate=!0),n.insufficient_material()&&(e.insufficientMaterial=!0),n.in_threefold_repetition()&&(e.inThreefoldRepetition=!0),n.in_checkmate()&&(e.inCheckmate=!0)),n.in_check()&&(e.inCheck=!0)}historyToMove(e){const n=[];let t=e;for(n.push(t);t.previous;)n.push(t.previous),t=t.previous;return n.reverse()}addMove(e,n,t=!0){n||this.moves.length>0&&(n=this.moves[this.moves.length-1]);const r=new g.Chess(this.setUpFen?this.setUpFen:void 0);if(n){const e=this.historyToMove(n);for(const n of e)r.move(n)}const o=r.move(e,{sloppy:t});if(!o)throw new Error("invalid move");return this.fillMoveFromChessState(o,r),n?(o.previous=n,o.ply=n.ply+1,n.next?(n.next.variations.push([]),o.variation=n.next.variations[n.next.variations.length-1],o.variation.push(o)):(n.next=o,o.variation=n.variation,n.variation.push(o))):(o.variation=this.moves,o.ply=1,this.moves.push(o)),o}render(){let e="";for(const n of this.moves)e+=n.san+" ";return e}constructor(e,n,t=!1){if(e){const r=class{static parse(e,n){return f(e,n)}}.parse(e.replace(/\s\s+/g," ").replace(/\n/g," "));this.moves=this.traverse(r[0],n,void 0,1,t)}else this.clear();this.setUpFen=n}}class R{render(){let e="";return e+=this.header.render(),e+="\n",e+=this.history.render(),e}constructor(e="",n={}){const t="]"===e.trim().substr(-1)?e.length:e.lastIndexOf("]\n\n")+1,r=e.substr(0,t),o=e.substr(t),a=!!n.sloppy;this.header=new u(r),"1"===this.header.tags[s]&&this.header.tags[l]?this.history=new x(o,this.header.tags[l],a):this.history=new x(o,void 0,a)}}var B={};Object.defineProperty(B,"__esModule",{value:!0});var y=/^\s*([prnbqkPRNBQK12345678]{1,8}(?:\/[prnbqkPRNBQK12345678]{1,8}){7})\s+(w|b)\s+([KQkqA-Ha-h]{1,4}|\-)\s+(?:(?:([a-h][36]|\-)\s+(\d{1,3})\s+(\d{1,4}))|(?:0\s+0))\s*$/,Q=/[1-8]+/g,E=/\-+/g,A={1:"-",2:"--",3:"---",4:"----",5:"-----",6:"------",7:"-------",8:"--------"},C=function(){function e(e){this.original="",this.isValid=!1,this.positions="",this.ranks=[],this.turn="",this.castles="",this.enpass="",this.halfmoveClock=0,this.moveNumber=0,this.original="string"==typeof e?e:"";var n=this.original.match(y);this.isValid=!!n,n&&(this.positions=n[1],this.ranks=n[1].split("/").map((function(e){return e.replace(Q,(function(e){return A[e]}))})),this.turn=n[2],this.castles=n[3],this.enpass=void 0!==n[4]?n[4]:"-",this.halfmoveClock=void 0!==n[5]?parseInt(n[5],10):0,this.moveNumber=void 0!==n[6]?parseInt(n[6],10):1,this.isValid=this.ranks.reduce((function(e,n){return e&&8===n.length}),!0))}return e.prototype.toString=function(){return this.ranks.map((function(e){return e.replace(E,(function(e){return e.length.toString()}))})).join("/")+" "+this.turn+" "+this.castles+" "+this.enpass+" "+this.halfmoveClock+" "+this.moveNumber},e.prototype.hasPiece=function(e){return this.positions.indexOf(e)>=0},e.prototype.counts=function(){for(var e={},n=0,t=this.ranks;n<t.length;n++)for(var r=0,o=t[n];r<o.length;r++){var a=o[r];"-"!==a&&(e[a]=(e[a]||0)+1)}return e},e.isFen=function(e){return"string"==typeof e&&y.test(e)},e}();B.FenParser=C,B.default=C;const N=['[Event "Match"]\n[Site "Philadelphie, USA"]\n[Date "1996.02.10"]\n[Round "1"]\n[White "Deep Blue (Computer)"]\n[Black "Garry Kasparov"]\n[Result "1-0"]\n[ECO "B22"]\n[PlyCount "73"]\n[EventDate "1996.??.??"]\n[WhiteElo ""]\n[BlackElo ""]\n\n1. e4 c5 {Garry choisi sa défense favorite contre 1.e4} 2. c3\n{L\'ordinateur évite les grandes lignes en jouant l\'Alapine.} 2... d5 3.\nexd5 Qxd5 4. d4 Nf6 5. Nf3 Bg4 6. Be2 e6 7. h3 Bh5 8. O-O Nc6 9. Be3 cxd4 10.\ncxd4 Bb4 {Un coup assez rare.} (10... Be7 {Est le coup le plus joué dans\ncette position.} 11. Nc3 Qd6) 11. a3 Ba5 12. Nc3 Qd6 13. Nb5 Qe7 14. Ne5 Bxe2\n15. Qxe2 O-O 16. Rac1 Rac8 {Les deux camps ont terminé leur\ndéveloppement et activé toutes leurs pièces. Les blancs\njouent avec un pion isolé et vont devoir être très actifs\npour justifier cette légère faiblesse.} 17. Bg5 Bb6 18. Bxf6 gxf6\n19. Nc4 Rfd8 20. Nxb6 axb6 21. Rfd1 f5 22. Qe3 {Les blancs activent leur dame et\nmenace d\'envahir l\'aile roi adverse.} 22... Qf6 23. d5 Rxd5 24. Rxd5 exd5 25. b3\nKh8 26. Qxb6 Rg8 {Pour compenser leur structure de pions ruinée, les\nnoirs tentent d\'organiser une attaque.} 27. Qc5 d4 $2 (27... f4 {garde la position\n&agrave; peu près égale.}) 28. Nd6 $1 f4 29. Nxb7 Ne5 30. Qd5 f3 31.\ng3 Nd3 32. Rc7 {Les pièces blanches se coordonnent pour attaquer la\nposition noire.} 32... Re8 $4 {L\'erreur fatale.} 33. Nd6 Re1+ 34. Kh2 Nxf2 35.\nNxf7+ Kg7 36. Ng5+ Kh6 37. Rxh7+ {C\'est la première fois qu\'un ordinateur\nbat le champion du monde en cadence classique. Un moment historique  $1} 1-0','[Event "Match"]\n[Site "Philadelphie USA"]\n[Date "1996.02.11"]\n[Round "2"]\n[White "Garry Kasparov"]\n[Black "Deep Blue (Computer)"]\n[Result "1-0"]\n[ECO "E04"]\n[PlyCount "145"]\n[EventDate "1996.??.??"]\n[WhiteElo ""]\n[BlackElo ""]\n\n1. Nf3 d5 2. d4 e6 3. g3 c5 4. Bg2 Nc6 5. O-O Nf6 6. c4 dxc4 7. Ne5 Bd7 8. Na3\ncxd4 9. Naxc4 Bc5 10. Qb3 O-O 11. Qxb7 Nxe5 12. Nxe5 Rb8 13. Qf3 Bd6 14. Nc6\nBxc6 15. Qxc6 e5 16. Rb1 Rb6 17. Qa4 Qb8 18. Bg5 Be7 19. b4 {Kasparov sacrifie\nle pion b pour s\'ouvrir un chemin vers le roi noir.} 19... Bxb4 20. Bxf6 gxf6\n(20... Rxf6 21. Rxb4 Qc8 {et les blancs gagnent une pi&egrave;ce.}) 21. Qd7 Qc8\n22. Qxa7 Rb8 23. Qa4 {L\'&eacute;quilibre mat&eacute;riel est restaur&eacute;,\nmais la position du roi noir n\'est pas enviable.} 23... Bc3 24. Rxb8 Qxb8 25.\nBe4 Qc7 {Il faut stopper l\'id&eacute;e Dd7-f5.} 26. Qa6 Kg7 27. Qd3 Rb8 (27...\nh6 28. Qf3 Rb8 29. Qf5) 28. Bxh7 Rb2 29. Be4 Rxa2 30. h4 Qc8 31. Qf3 Ra1 32.\nRxa1 Bxa1 33. Qh5 {La pr&eacute;sence de fous de couleurs oppos&eacute;es laisse\ndes chances de nulle &agrave; Deep Blue, mais Kasparov pousse &agrave; chaque\ncoup pour garder l\'initiative.} 33... Qh8 34. Qg4+ {Hors de question\nd\'&eacute;changer les dames  $1} 34... Kf8 35. Qc8+ Kg7 36. Qg4+ Kf8 37. Bd5 Ke7\n38. Bc6 {A chaque coup, Kasparov tente de poser des probl&egrave;mes &agrave;\nl\'ordinateur.} 38... Kf8 39. Bd5 Ke7 40. Qf3 Bc3 41. Bc4 Qc8 42. Qd5 Qe6 43. Qb5\n{Toujours pas  $1} 43... Qd7 {Les noirs tentent d&eacute;sesp&eacute;r&eacute;ment\nde rentrer dans une finale de fous de couleurs oppos&eacute;es.} 44. Qc5+ Qd6\n45. Qa7+ Qd7 46. Qa8 Qc7 47. Qa3+ Qd6 48. Qa2 f5 49. Bxf7 {La patience du\nchampion du monde paie. Il gagne un pion primordial.} 49... e4 50. Bh5 Qf6 51.\nQa3+ Kd7 52. Qa7+ Kd8 53. Qb8+ Kd7 54. Be8+ $1 {La chasse au roi commence  $1} 54...\nKe7 55. Bb5 Bd2 56. Qc7+ Kf8 57. Bc4 {Kasparov continue &agrave; priver le roi\nnoir de cases de fuites importantes.} 57... Bc3 58. Kg2 Be1 59. Kf1 Bc3 60. f4 $1\n{Maintenant que le roi adverse est coinc&eacute;, les blancs peuvent aller de\nl\'avant.} 60... exf3 61. exf3 Bd2 62. f4 Ke8 63. Qc8+ Ke7 64. Qc5+ Kd8 65. Bd3\nBe3 66. Qxf5 Qc6 67. Qf8+ Kc7 68. Qe7+ Kc8 69. Bf5+ Kb8 70. Qd8+ Kb7 71. Qd7+\n{Kasparov &eacute;change finalement les dames selon ses conditions. Le pion\npass&eacute; va d&eacute;cider.} 71... Qxd7 72. Bxd7 Kc7 73. Bb5 1-0','[Event "Match"]\n[Site "Philadelphie, USA"]\n[Date "1996.02.13"]\n[Round "3"]\n[White "Deep Blue (Computer)"]\n[Black "Garry Kasparov"]\n[Result "1/2-1/2"]\n[ECO "B22"]\n[PlyCount "78"]\n[EventDate "1996.??.??"]\n[WhiteElo ""]\n[BlackElo ""]\n\n1. e4 c5 2. c3 d5 3. exd5 Qxd5 4. d4 Nf6 5. Nf3 Bg4 6. Be2 e6 7. O-O {Deep Blue\nest le premier &agrave; d&eacute;vier. Dans la premi&egrave;re partie,\nl\'ordinateur avait pos&eacute; une question au fou g4 par h3.} 7... Nc6 8. Be3\ncxd4 9. cxd4 Bb4 10. a3 Ba5 11. Nc3 Qd6 12. Ne5 Bxe2 13. Qxe2 Bxc3 {Cette fois,\nKasparov d&eacute;cide de ne pas laisser le cavalier rentrer en b5 et\nl\'&eacute;change contre le fou de cases noires.} 14. bxc3 Nxe5 15. Bf4 Nf3+ 16.\nQxf3 Qd5 17. Qd3 Rc8 18. Rfc1 Qc4 19. Qxc4 Rxc4 {Rentre dans une finale de tours\navec fou contre cavalier. Kasparov va pouvoir essayer d\'exploiter les quelques\npions faibles de la position blanche.} 20. Rcb1 b6 21. Bb8 Ra4 22. Rb4 {Deep\nBlue joue avec &eacute;nergie, essayant de s\'activer au maximum face &agrave; un\ncamp noir pas encore totalement d&eacute;velopp&eacute;.} 22... Ra5 23. Rc4 O-O\n24. Bd6 Ra8 25. Rc6 b5 26. Kf1 Ra4 27. Rb1 a6 28. Ke2 h5 {Offre un peu d\'espace\nau roi noir et joue sur les deux flancs de l\'&eacute;chiquier.} 29. Kd3 {Les\nblancs centralisent leur roi pour la finale.} 29... Rd8 30. Be7 Rd7 31. Bxf6\n{Les blancs se s&eacute;parent du fou pour cr&eacute;er quelques faiblesses dans\nle camp adverse.} 31... gxf6 32. Rb3 Kg7 33. Ke3 e5 34. g3 exd4+ 35. cxd4 Re7+\n36. Kf3 Rd7 37. Rd3 Raxd4 38. Rxd4 Rxd4 39. Rxa6 b4 {Les pions de l\'aile dame\nsont &eacute;chang&eacute;s, et la finale de tours avec trois pions contre trois\n&agrave; l\'aile roi est une nulle connue.} 1/2-1/2','[Event "Match"]\n[Site "Philadelphie, USA"]\n[Date "1996.02.14"]\n[Round "4"]\n[White "Garry Kasparov"]\n[Black "Deep Blue (Computer)"]\n[Result "1/2-1/2"]\n[ECO "D46"]\n[PlyCount "100"]\n[EventDate "1996.??.??"]\n[WhiteElo ""]\n[BlackElo ""]\n\n1. Nf3 {Kasparov reste fid&egrave;le &agrave; sa strat&eacute;gie en gardant le\njeu ferm&eacute;.} 1... d5 2. d4 c6 3. c4 e6 4. Nbd2 Nf6 5. e3 Nbd7 6. Bd3 Bd6\n7. e4 dxe4 8. Nxe4 Nxe4 9. Bxe4 O-O 10. O-O h6 11. Bc2 {Kasparov a un fort\ncentre et un avantage d\'espace qui va l\'avantager &agrave; long-terme.} 11... e5\n{les noirs cherchent du contre-jeu en s\'activant.} 12. Re1 exd4 13. Qxd4 Bc5 14.\nQc3 a5 15. a3 Nf6 16. Be3 Bxe3 17. Rxe3 Bg4 18. Ne5 Re8 19. Rae1 Be6 20. f4 Qc8\n21. h3 b5 22. f5 Bxc4 23. Nxc4 bxc4 24. Rxe8+ Nxe8 25. Re4 Nf6 (25... Qxf5 26.\nRxe8+ Rxe8 27. Bxf5 {aurait &eacute;t&eacute; une erreur &eacute;trange  $1}) 26.\nRxc4 Nd5 27. Qe5 Qd7 28. Rg4 f6 29. Qd4 Kh7 30. Re4 Rd8 31. Kh1 Qc7 32. Qf2 Qb8\n33. Ba4 c5 34. Bc6 c4 35. Rxc4 Nb4 36. Bf3 (36. axb4 $4 Rd1+ 37. Qg1 Rxg1+ 38.\nKxg1 axb4 {et les noirs gagnent.}) 36... Nd3 37. Qh4 $6 {Kasparov perd le fil. Il\naurait &eacute;t&eacute; plus solide de laisser la dame au centre.} (37. Qe3\nQxb2 38. Qe7 Qa1+ 39. Kh2 Qe5+ 40. Qxe5 Nxe5 41. Rc5 Nxf3+ 42. gxf3 a4 43. Ra5\nRd3 44. Rxa4 Rxf3 $11) 37... Qxb2 38. Qg3 Qxa3 39. Rc7 Qf8 40. Ra7 Ne5 41. Rxa5\nQf7 42. Rxe5 $5 {Kasparov voit qu\'il peut construire une forteresse et assurer la\nnulle.} 42... fxe5 43. Qxe5 Re8 44. Qf4 Qf6 45. Bh5 Rf8 46. Bg6+ Kh8 47. Qc7 Qd4\n48. Kh2 Ra8 49. Bh5 Qf6 50. Bg6 Rg8 {La nulle est sign&eacute;e. Aucun camp ne\npeut progresser.} 1/2-1/2','[Event "Match"]\n[Site "Philadelphie, USA"]\n[Date "1996.02.16"]\n[Round "5"]\n[White "Deep Blue (Computer)"]\n[Black "Garry Kasparov"]\n[Result "0-1"]\n[ECO "C47"]\n[PlyCount "94"]\n[EventDate "1996.??.??"]\n[WhiteElo ""]\n[BlackElo ""]\n\n1. e4 e5 $1 {Un coup somme toute logique, mais quelle surprise de ne pas voir\nKasparov jouer son chouchou 1...c5  $1} 2. Nf3 Nf6 {La d&eacute;fense russe, un\nchoix solide.} 3. Nc3 (3. Nxe5 d6 4. Nf3 Nxe4 {Est une suite plus\nth&eacute;orique, mais Deep Blue pr&eacute;f&egrave;re d&eacute;velopper ses\npi&egrave;ces.}) 3... Nc6 4. d4 {L\'&eacute;cossaise des quatre cavaliers. Encore\nun choix solide.} (4. Bb5 {est l\'espagnole des quatre cavaliers.}) 4... exd4 5.\nNxd4 Bb4 6. Nxc6 bxc6 7. Bd3 d5 8. exd5 cxd5 9. O-O O-O 10. Bg5 c6 11. Qf3 Be7\n(11... Bd6 {Un coup aujourd\'hui plus en vogue. Les noirs ne craignent pas de\nvoir les blancs endommager leur roque, car ils obtiendraient la paire de fous et\ndes lignes ouvertes vers le roi adverse.}) 12. Rae1 (12. h3 {Un coup plus commun\ndirig&eacute; contre l\'invasion du fou de cases blanches.}) 12... Re8 13. Ne2 h6\n14. Bf4 Bd6 15. Nd4 Bg4 16. Qg3 Bxf4 17. Qxf4 Qb6 18. c4 Bd7 19. cxd5 cxd5 20.\nRxe8+ Rxe8 21. Qd2 Ne4 22. Bxe4 dxe4 23. b3 Rd8 {Dans cette position totalement\n&eacute;gale, Kasparov propose la nulle &agrave; Deep Blue, mais l\'ordinateur la\nrefuse.} 24. Qc3 f5 25. Rd1 Be6 26. Qe3 Bf7 27. Qc3 f4 {Profitant des errements\ndes blancs, Kasparov se saisit de l\'initiative pour ne plus la l&acirc;cher  $1}\n28. Rd2 Qf6 29. g3 Rd5 30. a3 Kh7 {Le russe est maintenant gagnant  $1} 31. Kg2\nQe5 $3 32. f3 e3 33. Rd3 e2 34. gxf4 e1=Q 35. fxe5 Qxc3 36. Rxc3 Rxd4 37. b4 Bc4\n38. Kf2 g5 39. Re3 Be6 40. Rc3 Bc4 41. Re3 Rd2+ 42. Ke1 Rd3 43. Kf2 Kg6 44. Rxd3\nBxd3 45. Ke3 Bc2 46. Kd4 Kf5 47. Kd5 h5 {Deep Blue abandonne  $1 Une fois\nl\'initiative pass&eacute;e aux mains du champion du monde, l\'IA n\'a rien pu\nfaire. Une belle victoire de l\'homme sur la machine.} 0-1','[Event "Match"]\n[Site "Philadelphie, USA"]\n[Date "1996.02.17"]\n[Round "6"]\n[White "Garry Kasparov"]\n[Black "Deep Blue (Computer)"]\n[Result "1-0"]\n[ECO "D30"]\n[PlyCount "85"]\n[EventDate "1996.??.??"]\n[WhiteElo ""]\n[BlackElo ""]\n\n1. Nf3 {Kasparov choisit &agrave; nouveau le terrain du combat\nstrat&eacute;gique.} 1... d5 2. d4 c6 3. c4 e6 4. Nbd2 Nf6 5. e3 c5 6. b3 Nc6 7.\nBb2 cxd4 8. exd4 Be7 9. Rc1 O-O 10. Bd3 Bd7 11. O-O {Kasparov a termin&eacute;\nson d&eacute;veloppement. Il a le contr&ocirc;le du centre et des pi&egrave;ces\nplus actives.} 11... Nh5 12. Re1 Nf4 13. Bb1 Bd6 14. g3 Ng6 15. Ne5 Rc8 16. Nxd7\nQxd7 17. Nf3 Bb4 18. Re3 Rfd8 19. h4 Nge7 20. a3 $1 {Le russe obtient un avantage\nmassif  $1} (20. Bxh7+ $1 {Ce coup gagne &eacute;galement, mais de mani&egrave;re\nplus compliqu&eacute;e} 20... Kxh7 21. Ng5+ Kg8 22. Qh5 Qe8 23. Qh7+ Kf8 24.\nQh8+ Ng8 25. Rc2 {et les blancs vont l\'emporter, mais Garry veut &eacute;viter\ntoute erreur de calcul potentielle.}) 20... Ba5 21. b4 (21. Bxh7+ {&eacute;tait\nencore possible.}) 21... Bc7 22. c5 {Dur de trouver un plan pour les noirs, qui\nsont totalement &eacute;touff&eacute;s. Kasparov, lui, peut jouer au centre ou\nattaquer &agrave; l\'aile roi.} 22... Re8 23. Qd3 g6 24. Re2 Nf5 25. Bc3 h5 26.\nb5 Nce7 27. Bd2 Kg7 28. a4 Ra8 29. a5 a6 30. b6 Bb8 31. Bc2 {Les noirs semblent\nsur le point de se faire bouter hors de l\'&eacute;chiquier  $1} 31... Nc6 32. Ba4\nRe7 33. Bc3 Ne5 34. dxe5 Qxa4 35. Nd4 Nxd4 36. Qxd4 Qd7 37. Bd2 Re8 38. Bg5\n{Kasparov contr&ocirc;le l\'int&eacute;gralit&eacute; du plateau.} 38... Rc8 39.\nBf6+ {Les cases noires sont maintenant sous pression  $1} 39... Kh7 40. c6 $3 {Le\nbouquet final.} 40... bxc6 41. Qc5 Kh6 42. Rb2 Qb7 43. Rb4 {et les noirs n\'ont\nplus le moindre coup utile. Deep Blue abandonne.} 1-0'],K=document.getElementById("prev-js"),S=document.getElementById("play-js"),w=document.getElementById("next-js"),k=document.getElementById("stop-js"),P=document.getElementById("delay-js"),T=document.getElementById("game-js"),O=[...document.getElementsByClassName("audio-input")];let _,$,L,I,q={},D=0;const U=new function(e){this.ctx=e.getContext("2d"),this.width=e.width,this.height=e.width,this.cellWidth=this.width/8,this.cellHeight=this.height/8,this.draw=function(){this.ctx.clearRect(0,0,this.width,this.height);for(let e=0;e<64;e++){const n=Math.floor(e/8),t=e-8*n,r="rgb(233, 244, 251)";this.ctx.strokeStyle=r,this.ctx.strokeRect(t*this.cellWidth,n*this.cellHeight,this.cellWidth,this.cellHeight)}}}(document.getElementById("chessboard"));function W(s){D=0,_=new R(N[s]),$=_.history.moves.map((n=>new(e(B))(n.fen).ranks));const l=new(e(B))("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1");$.unshift(l.ranks),I=[],$.forEach((e=>{const s=[];e.forEach(((e,l)=>{[...e].forEach(((e,u)=>{"P"===e?s.push(new n({y:u,x:7-l},!0)):"p"===e?s.push(new n({y:u,x:7-l},!1)):"r"===e?s.push(new t({y:u,x:7-l},!1)):"R"===e?s.push(new t({y:u,x:7-l},!0)):"n"===e?s.push(new r({y:u,x:7-l},!1)):"N"===e?s.push(new r({y:u,x:7-l},!0)):"b"===e?s.push(new o({y:u,x:7-l},!1)):"B"===e?s.push(new o({y:u,x:7-l},!0)):"q"===e?s.push(new a({y:u,x:7-l},!1)):"Q"===e?s.push(new a({y:u,x:7-l},!0)):"k"===e?s.push(new i({y:u,x:7-l},!1)):"K"===e&&s.push(new i({y:u,x:7-l},!0))}))})),I.push(s)})),L=_.history.moves.map((e=>e.flags))}function j(){U.draw(),I[D].forEach((e=>{e.draw(U)}))}function M(){const e=L[D];q[e]&&q[e].play()}let F;O.forEach((e=>{e.addEventListener("change",(e=>{const n=e.target.id;if(!e.target.files.length)return;const t=URL.createObjectURL(e.target.files[0]);q[n]=document.createElement("audio"),q[n].addEventListener("load",(()=>{URL.revokeObjectURL(t)})),q[n].controls="true",q[n].src=t,q[n].play()}))})),T.addEventListener("change",(e=>{W(e.target.value)})),w.addEventListener("click",(e=>{M(),D=Math.min(D+1,I.length-1),j()})),K.addEventListener("click",(e=>{D=Math.max(D-1,0),j()})),k.addEventListener("click",(e=>{D=0,G&&H(),j()}));let G=!1;function H(){G=!G,S.innerHTML=G?'<i class="fa fa-pause" aria-hidden="true"></i>':'<i class="fa fa-play" aria-hidden="true"></i>',G?F=window.setInterval((()=>{M(),D++,D>=I.length-1?H():j()}),1e3*P.value):clearInterval(F)}S.addEventListener("click",H),W(0),j();
//# sourceMappingURL=index.ad5655d2.js.map
